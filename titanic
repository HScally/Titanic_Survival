{
  "cells": [
    {
      "metadata": {
        "_cell_guid": "b1076dfc-b9ad-4769-8c92-a6c4dae69d19",
        "_uuid": "8f2839f25d086af736a60e9eeb907d3b93b6e0e5",
        "trusted": true
      },
      "cell_type": "code",
      "source": "# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle/python docker image: https://github.com/kaggle/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nfrom sklearn.model_selection import train_test_split\nfrom  sklearn.linear_model import LogisticRegression\nimport math\nimport warnings\n\n%matplotlib inline\nwarnings.filterwarnings('ignore')\n\n# Input data files are available in the \"../input/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"../input\"))\n\n# Any results you write to the current directory are saved as output.",
      "execution_count": 126,
      "outputs": [
        {
          "output_type": "stream",
          "text": "['train.csv', 'test.csv', 'gender_submission.csv']\n",
          "name": "stdout"
        }
      ]
    },
    {
      "metadata": {
        "_cell_guid": "79c7e3d0-c299-4dcb-8224-4455121ee9b0",
        "_uuid": "d629ff2d2480ee46fbb7e2d37f6b5fab8052498a",
        "trusted": true
      },
      "cell_type": "code",
      "source": "dataset = pd.read_csv('../input/train.csv')",
      "execution_count": 127,
      "outputs": []
    },
    {
      "metadata": {
        "trusted": true,
        "_uuid": "a4cee69526177a9b4aa118af71d64653b8a4c065"
      },
      "cell_type": "code",
      "source": "dataset.describe()",
      "execution_count": 128,
      "outputs": [
        {
          "output_type": "execute_result",
          "execution_count": 128,
          "data": {
            "text/plain": "       PassengerId    Survived      Pclass         Age       SibSp  \\\ncount   891.000000  891.000000  891.000000  714.000000  891.000000   \nmean    446.000000    0.383838    2.308642   29.699118    0.523008   \nstd     257.353842    0.486592    0.836071   14.526497    1.102743   \nmin       1.000000    0.000000    1.000000    0.420000    0.000000   \n25%     223.500000    0.000000    2.000000   20.125000    0.000000   \n50%     446.000000    0.000000    3.000000   28.000000    0.000000   \n75%     668.500000    1.000000    3.000000   38.000000    1.000000   \nmax     891.000000    1.000000    3.000000   80.000000    8.000000   \n\n            Parch        Fare  \ncount  891.000000  891.000000  \nmean     0.381594   32.204208  \nstd      0.806057   49.693429  \nmin      0.000000    0.000000  \n25%      0.000000    7.910400  \n50%      0.000000   14.454200  \n75%      0.000000   31.000000  \nmax      6.000000  512.329200  ",
            "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>PassengerId</th>\n      <th>Survived</th>\n      <th>Pclass</th>\n      <th>Age</th>\n      <th>SibSp</th>\n      <th>Parch</th>\n      <th>Fare</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>count</th>\n      <td>891.000000</td>\n      <td>891.000000</td>\n      <td>891.000000</td>\n      <td>714.000000</td>\n      <td>891.000000</td>\n      <td>891.000000</td>\n      <td>891.000000</td>\n    </tr>\n    <tr>\n      <th>mean</th>\n      <td>446.000000</td>\n      <td>0.383838</td>\n      <td>2.308642</td>\n      <td>29.699118</td>\n      <td>0.523008</td>\n      <td>0.381594</td>\n      <td>32.204208</td>\n    </tr>\n    <tr>\n      <th>std</th>\n      <td>257.353842</td>\n      <td>0.486592</td>\n      <td>0.836071</td>\n      <td>14.526497</td>\n      <td>1.102743</td>\n      <td>0.806057</td>\n      <td>49.693429</td>\n    </tr>\n    <tr>\n      <th>min</th>\n      <td>1.000000</td>\n      <td>0.000000</td>\n      <td>1.000000</td>\n      <td>0.420000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>25%</th>\n      <td>223.500000</td>\n      <td>0.000000</td>\n      <td>2.000000</td>\n      <td>20.125000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>7.910400</td>\n    </tr>\n    <tr>\n      <th>50%</th>\n      <td>446.000000</td>\n      <td>0.000000</td>\n      <td>3.000000</td>\n      <td>28.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>14.454200</td>\n    </tr>\n    <tr>\n      <th>75%</th>\n      <td>668.500000</td>\n      <td>1.000000</td>\n      <td>3.000000</td>\n      <td>38.000000</td>\n      <td>1.000000</td>\n      <td>0.000000</td>\n      <td>31.000000</td>\n    </tr>\n    <tr>\n      <th>max</th>\n      <td>891.000000</td>\n      <td>1.000000</td>\n      <td>3.000000</td>\n      <td>80.000000</td>\n      <td>8.000000</td>\n      <td>6.000000</td>\n      <td>512.329200</td>\n    </tr>\n  </tbody>\n</table>\n</div>"
          },
          "metadata": {}
        }
      ]
    },
    {
      "metadata": {
        "trusted": true,
        "_uuid": "b7aa7da9cc8269c36deae20ed69854b2a7ac1c4b"
      },
      "cell_type": "code",
      "source": "print(\"Mean Age: {}\".format(round(dataset['Age'].mean(), 2)))\nprint(\"Mean Age: {}\".format(round(dataset['Age'].median(), 2)))\nprint(\"-\"*100)\nprint(\"Mean Fare: {}\".format(round(dataset['Fare'].mean(), 2)))\nprint(\"Mean Fare: {}\".format(round(dataset['Fare'].median(), 2)))",
      "execution_count": 129,
      "outputs": [
        {
          "output_type": "stream",
          "text": "Mean Age: 29.7\nMean Age: 28.0\n----------------------------------------------------------------------------------------------------\nMean Fare: 32.2\nMean Fare: 14.45\n",
          "name": "stdout"
        }
      ]
    },
    {
      "metadata": {
        "trusted": true,
        "_uuid": "2e005227e7f224ce8b2a650341e77fbc3b58debb"
      },
      "cell_type": "code",
      "source": "dataset['Age'].fillna(dataset.Age.mean(), inplace=True)",
      "execution_count": 130,
      "outputs": []
    },
    {
      "metadata": {
        "trusted": true,
        "_uuid": "951d1f32423c08cad68ce4f40dcee1dc1cfbc76e"
      },
      "cell_type": "code",
      "source": "dataset.info()",
      "execution_count": 131,
      "outputs": [
        {
          "output_type": "stream",
          "text": "<class 'pandas.core.frame.DataFrame'>\nRangeIndex: 891 entries, 0 to 890\nData columns (total 12 columns):\nPassengerId    891 non-null int64\nSurvived       891 non-null int64\nPclass         891 non-null int64\nName           891 non-null object\nSex            891 non-null object\nAge            891 non-null float64\nSibSp          891 non-null int64\nParch          891 non-null int64\nTicket         891 non-null object\nFare           891 non-null float64\nCabin          204 non-null object\nEmbarked       889 non-null object\ndtypes: float64(2), int64(5), object(5)\nmemory usage: 83.6+ KB\n",
          "name": "stdout"
        }
      ]
    },
    {
      "metadata": {
        "trusted": true,
        "collapsed": true,
        "_uuid": "28e3449cbca5b8e8512147e9c989ad8d33576674"
      },
      "cell_type": "code",
      "source": "def describe_categorical(X):\n    from IPython.display import display, HTML\n    display(HTML(X[X.columns[X.dtypes == 'object']].describe().to_html()))",
      "execution_count": 132,
      "outputs": []
    },
    {
      "metadata": {
        "trusted": true,
        "_uuid": "cf3872ac2e572ef25290202d2fda8093f64e1bbb"
      },
      "cell_type": "code",
      "source": "describe_categorical(dataset)",
      "execution_count": 133,
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "text/plain": "<IPython.core.display.HTML object>",
            "text/html": "<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Name</th>\n      <th>Sex</th>\n      <th>Ticket</th>\n      <th>Cabin</th>\n      <th>Embarked</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>count</th>\n      <td>891</td>\n      <td>891</td>\n      <td>891</td>\n      <td>204</td>\n      <td>889</td>\n    </tr>\n    <tr>\n      <th>unique</th>\n      <td>891</td>\n      <td>2</td>\n      <td>681</td>\n      <td>147</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>top</th>\n      <td>Collander, Mr. Erik Gustaf</td>\n      <td>male</td>\n      <td>CA. 2343</td>\n      <td>G6</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>freq</th>\n      <td>1</td>\n      <td>577</td>\n      <td>7</td>\n      <td>4</td>\n      <td>644</td>\n    </tr>\n  </tbody>\n</table>"
          },
          "metadata": {}
        }
      ]
    },
    {
      "metadata": {
        "trusted": true,
        "collapsed": true,
        "_uuid": "8ad788f636a298baffd154159b2d09e8b06c9687"
      },
      "cell_type": "code",
      "source": "dataset['Cabin'] = dataset.Cabin.fillna(0)\ndataset['Cabin'] = dataset['Cabin'].apply(lambda x: 1 if x == 0 else 1)",
      "execution_count": 134,
      "outputs": []
    },
    {
      "metadata": {
        "trusted": true,
        "collapsed": true,
        "_uuid": "29282a17a84a4b06c1a3d7eec7d6a6133d457b32"
      },
      "cell_type": "code",
      "source": "dataset['Sex'] = dataset['Sex'].apply(lambda x: 1 if x == 'female' else 0)",
      "execution_count": 135,
      "outputs": []
    },
    {
      "metadata": {
        "trusted": true,
        "_uuid": "ea5a2250e06823987c457f3069fbd61c45bc6fd1"
      },
      "cell_type": "code",
      "source": "dataset.head(100)",
      "execution_count": 136,
      "outputs": [
        {
          "output_type": "execute_result",
          "execution_count": 136,
          "data": {
            "text/plain": "    PassengerId  Survived  Pclass  \\\n0             1         0       3   \n1             2         1       1   \n2             3         1       3   \n3             4         1       1   \n4             5         0       3   \n5             6         0       3   \n6             7         0       1   \n7             8         0       3   \n8             9         1       3   \n9            10         1       2   \n10           11         1       3   \n11           12         1       1   \n12           13         0       3   \n13           14         0       3   \n14           15         0       3   \n15           16         1       2   \n16           17         0       3   \n17           18         1       2   \n18           19         0       3   \n19           20         1       3   \n20           21         0       2   \n21           22         1       2   \n22           23         1       3   \n23           24         1       1   \n24           25         0       3   \n25           26         1       3   \n26           27         0       3   \n27           28         0       1   \n28           29         1       3   \n29           30         0       3   \n..          ...       ...     ...   \n70           71         0       2   \n71           72         0       3   \n72           73         0       2   \n73           74         0       3   \n74           75         1       3   \n75           76         0       3   \n76           77         0       3   \n77           78         0       3   \n78           79         1       2   \n79           80         1       3   \n80           81         0       3   \n81           82         1       3   \n82           83         1       3   \n83           84         0       1   \n84           85         1       2   \n85           86         1       3   \n86           87         0       3   \n87           88         0       3   \n88           89         1       1   \n89           90         0       3   \n90           91         0       3   \n91           92         0       3   \n92           93         0       1   \n93           94         0       3   \n94           95         0       3   \n95           96         0       3   \n96           97         0       1   \n97           98         1       1   \n98           99         1       2   \n99          100         0       2   \n\n                                                 Name  Sex        Age  SibSp  \\\n0                             Braund, Mr. Owen Harris    0  22.000000      1   \n1   Cumings, Mrs. John Bradley (Florence Briggs Th...    1  38.000000      1   \n2                              Heikkinen, Miss. Laina    1  26.000000      0   \n3        Futrelle, Mrs. Jacques Heath (Lily May Peel)    1  35.000000      1   \n4                            Allen, Mr. William Henry    0  35.000000      0   \n5                                    Moran, Mr. James    0  29.699118      0   \n6                             McCarthy, Mr. Timothy J    0  54.000000      0   \n7                      Palsson, Master. Gosta Leonard    0   2.000000      3   \n8   Johnson, Mrs. Oscar W (Elisabeth Vilhelmina Berg)    1  27.000000      0   \n9                 Nasser, Mrs. Nicholas (Adele Achem)    1  14.000000      1   \n10                    Sandstrom, Miss. Marguerite Rut    1   4.000000      1   \n11                           Bonnell, Miss. Elizabeth    1  58.000000      0   \n12                     Saundercock, Mr. William Henry    0  20.000000      0   \n13                        Andersson, Mr. Anders Johan    0  39.000000      1   \n14               Vestrom, Miss. Hulda Amanda Adolfina    1  14.000000      0   \n15                   Hewlett, Mrs. (Mary D Kingcome)     1  55.000000      0   \n16                               Rice, Master. Eugene    0   2.000000      4   \n17                       Williams, Mr. Charles Eugene    0  29.699118      0   \n18  Vander Planke, Mrs. Julius (Emelia Maria Vande...    1  31.000000      1   \n19                            Masselmani, Mrs. Fatima    1  29.699118      0   \n20                               Fynney, Mr. Joseph J    0  35.000000      0   \n21                              Beesley, Mr. Lawrence    0  34.000000      0   \n22                        McGowan, Miss. Anna \"Annie\"    1  15.000000      0   \n23                       Sloper, Mr. William Thompson    0  28.000000      0   \n24                      Palsson, Miss. Torborg Danira    1   8.000000      3   \n25  Asplund, Mrs. Carl Oscar (Selma Augusta Emilia...    1  38.000000      1   \n26                            Emir, Mr. Farred Chehab    0  29.699118      0   \n27                     Fortune, Mr. Charles Alexander    0  19.000000      3   \n28                      O'Dwyer, Miss. Ellen \"Nellie\"    1  29.699118      0   \n29                                Todoroff, Mr. Lalio    0  29.699118      0   \n..                                                ...  ...        ...    ...   \n70                         Jenkin, Mr. Stephen Curnow    0  32.000000      0   \n71                         Goodwin, Miss. Lillian Amy    1  16.000000      5   \n72                               Hood, Mr. Ambrose Jr    0  21.000000      0   \n73                        Chronopoulos, Mr. Apostolos    0  26.000000      1   \n74                                      Bing, Mr. Lee    0  32.000000      0   \n75                            Moen, Mr. Sigurd Hansen    0  25.000000      0   \n76                                  Staneff, Mr. Ivan    0  29.699118      0   \n77                           Moutal, Mr. Rahamin Haim    0  29.699118      0   \n78                      Caldwell, Master. Alden Gates    0   0.830000      0   \n79                           Dowdell, Miss. Elizabeth    1  30.000000      0   \n80                               Waelens, Mr. Achille    0  22.000000      0   \n81                        Sheerlinck, Mr. Jan Baptist    0  29.000000      0   \n82                     McDermott, Miss. Brigdet Delia    1  29.699118      0   \n83                            Carrau, Mr. Francisco M    0  28.000000      0   \n84                                Ilett, Miss. Bertha    1  17.000000      0   \n85  Backstrom, Mrs. Karl Alfred (Maria Mathilda Gu...    1  33.000000      3   \n86                             Ford, Mr. William Neal    0  16.000000      1   \n87                      Slocovski, Mr. Selman Francis    0  29.699118      0   \n88                         Fortune, Miss. Mabel Helen    1  23.000000      3   \n89                             Celotti, Mr. Francesco    0  24.000000      0   \n90                               Christmann, Mr. Emil    0  29.000000      0   \n91                         Andreasson, Mr. Paul Edvin    0  20.000000      0   \n92                        Chaffee, Mr. Herbert Fuller    0  46.000000      1   \n93                            Dean, Mr. Bertram Frank    0  26.000000      1   \n94                                  Coxon, Mr. Daniel    0  59.000000      0   \n95                        Shorney, Mr. Charles Joseph    0  29.699118      0   \n96                          Goldschmidt, Mr. George B    0  71.000000      0   \n97                    Greenfield, Mr. William Bertram    0  23.000000      0   \n98               Doling, Mrs. John T (Ada Julia Bone)    1  34.000000      0   \n99                                  Kantor, Mr. Sinai    0  34.000000      1   \n\n    Parch            Ticket      Fare  Cabin Embarked  \n0       0         A/5 21171    7.2500      1        S  \n1       0          PC 17599   71.2833      1        C  \n2       0  STON/O2. 3101282    7.9250      1        S  \n3       0            113803   53.1000      1        S  \n4       0            373450    8.0500      1        S  \n5       0            330877    8.4583      1        Q  \n6       0             17463   51.8625      1        S  \n7       1            349909   21.0750      1        S  \n8       2            347742   11.1333      1        S  \n9       0            237736   30.0708      1        C  \n10      1           PP 9549   16.7000      1        S  \n11      0            113783   26.5500      1        S  \n12      0         A/5. 2151    8.0500      1        S  \n13      5            347082   31.2750      1        S  \n14      0            350406    7.8542      1        S  \n15      0            248706   16.0000      1        S  \n16      1            382652   29.1250      1        Q  \n17      0            244373   13.0000      1        S  \n18      0            345763   18.0000      1        S  \n19      0              2649    7.2250      1        C  \n20      0            239865   26.0000      1        S  \n21      0            248698   13.0000      1        S  \n22      0            330923    8.0292      1        Q  \n23      0            113788   35.5000      1        S  \n24      1            349909   21.0750      1        S  \n25      5            347077   31.3875      1        S  \n26      0              2631    7.2250      1        C  \n27      2             19950  263.0000      1        S  \n28      0            330959    7.8792      1        Q  \n29      0            349216    7.8958      1        S  \n..    ...               ...       ...    ...      ...  \n70      0        C.A. 33111   10.5000      1        S  \n71      2           CA 2144   46.9000      1        S  \n72      0      S.O.C. 14879   73.5000      1        S  \n73      0              2680   14.4542      1        C  \n74      0              1601   56.4958      1        S  \n75      0            348123    7.6500      1        S  \n76      0            349208    7.8958      1        S  \n77      0            374746    8.0500      1        S  \n78      2            248738   29.0000      1        S  \n79      0            364516   12.4750      1        S  \n80      0            345767    9.0000      1        S  \n81      0            345779    9.5000      1        S  \n82      0            330932    7.7875      1        Q  \n83      0            113059   47.1000      1        S  \n84      0        SO/C 14885   10.5000      1        S  \n85      0           3101278   15.8500      1        S  \n86      3        W./C. 6608   34.3750      1        S  \n87      0   SOTON/OQ 392086    8.0500      1        S  \n88      2             19950  263.0000      1        S  \n89      0            343275    8.0500      1        S  \n90      0            343276    8.0500      1        S  \n91      0            347466    7.8542      1        S  \n92      0       W.E.P. 5734   61.1750      1        S  \n93      2         C.A. 2315   20.5750      1        S  \n94      0            364500    7.2500      1        S  \n95      0            374910    8.0500      1        S  \n96      0          PC 17754   34.6542      1        C  \n97      1          PC 17759   63.3583      1        C  \n98      1            231919   23.0000      1        S  \n99      0            244367   26.0000      1        S  \n\n[100 rows x 12 columns]",
            "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>PassengerId</th>\n      <th>Survived</th>\n      <th>Pclass</th>\n      <th>Name</th>\n      <th>Sex</th>\n      <th>Age</th>\n      <th>SibSp</th>\n      <th>Parch</th>\n      <th>Ticket</th>\n      <th>Fare</th>\n      <th>Cabin</th>\n      <th>Embarked</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1</td>\n      <td>0</td>\n      <td>3</td>\n      <td>Braund, Mr. Owen Harris</td>\n      <td>0</td>\n      <td>22.000000</td>\n      <td>1</td>\n      <td>0</td>\n      <td>A/5 21171</td>\n      <td>7.2500</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2</td>\n      <td>1</td>\n      <td>1</td>\n      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>\n      <td>1</td>\n      <td>38.000000</td>\n      <td>1</td>\n      <td>0</td>\n      <td>PC 17599</td>\n      <td>71.2833</td>\n      <td>1</td>\n      <td>C</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>3</td>\n      <td>1</td>\n      <td>3</td>\n      <td>Heikkinen, Miss. Laina</td>\n      <td>1</td>\n      <td>26.000000</td>\n      <td>0</td>\n      <td>0</td>\n      <td>STON/O2. 3101282</td>\n      <td>7.9250</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>4</td>\n      <td>1</td>\n      <td>1</td>\n      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>\n      <td>1</td>\n      <td>35.000000</td>\n      <td>1</td>\n      <td>0</td>\n      <td>113803</td>\n      <td>53.1000</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>5</td>\n      <td>0</td>\n      <td>3</td>\n      <td>Allen, Mr. William Henry</td>\n      <td>0</td>\n      <td>35.000000</td>\n      <td>0</td>\n      <td>0</td>\n      <td>373450</td>\n      <td>8.0500</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>6</td>\n      <td>0</td>\n      <td>3</td>\n      <td>Moran, Mr. James</td>\n      <td>0</td>\n      <td>29.699118</td>\n      <td>0</td>\n      <td>0</td>\n      <td>330877</td>\n      <td>8.4583</td>\n      <td>1</td>\n      <td>Q</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>7</td>\n      <td>0</td>\n      <td>1</td>\n      <td>McCarthy, Mr. Timothy J</td>\n      <td>0</td>\n      <td>54.000000</td>\n      <td>0</td>\n      <td>0</td>\n      <td>17463</td>\n      <td>51.8625</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>8</td>\n      <td>0</td>\n      <td>3</td>\n      <td>Palsson, Master. Gosta Leonard</td>\n      <td>0</td>\n      <td>2.000000</td>\n      <td>3</td>\n      <td>1</td>\n      <td>349909</td>\n      <td>21.0750</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>9</td>\n      <td>1</td>\n      <td>3</td>\n      <td>Johnson, Mrs. Oscar W (Elisabeth Vilhelmina Berg)</td>\n      <td>1</td>\n      <td>27.000000</td>\n      <td>0</td>\n      <td>2</td>\n      <td>347742</td>\n      <td>11.1333</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>10</td>\n      <td>1</td>\n      <td>2</td>\n      <td>Nasser, Mrs. Nicholas (Adele Achem)</td>\n      <td>1</td>\n      <td>14.000000</td>\n      <td>1</td>\n      <td>0</td>\n      <td>237736</td>\n      <td>30.0708</td>\n      <td>1</td>\n      <td>C</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>11</td>\n      <td>1</td>\n      <td>3</td>\n      <td>Sandstrom, Miss. Marguerite Rut</td>\n      <td>1</td>\n      <td>4.000000</td>\n      <td>1</td>\n      <td>1</td>\n      <td>PP 9549</td>\n      <td>16.7000</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>12</td>\n      <td>1</td>\n      <td>1</td>\n      <td>Bonnell, Miss. Elizabeth</td>\n      <td>1</td>\n      <td>58.000000</td>\n      <td>0</td>\n      <td>0</td>\n      <td>113783</td>\n      <td>26.5500</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>13</td>\n      <td>0</td>\n      <td>3</td>\n      <td>Saundercock, Mr. William Henry</td>\n      <td>0</td>\n      <td>20.000000</td>\n      <td>0</td>\n      <td>0</td>\n      <td>A/5. 2151</td>\n      <td>8.0500</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>14</td>\n      <td>0</td>\n      <td>3</td>\n      <td>Andersson, Mr. Anders Johan</td>\n      <td>0</td>\n      <td>39.000000</td>\n      <td>1</td>\n      <td>5</td>\n      <td>347082</td>\n      <td>31.2750</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>15</td>\n      <td>0</td>\n      <td>3</td>\n      <td>Vestrom, Miss. Hulda Amanda Adolfina</td>\n      <td>1</td>\n      <td>14.000000</td>\n      <td>0</td>\n      <td>0</td>\n      <td>350406</td>\n      <td>7.8542</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>16</td>\n      <td>1</td>\n      <td>2</td>\n      <td>Hewlett, Mrs. (Mary D Kingcome)</td>\n      <td>1</td>\n      <td>55.000000</td>\n      <td>0</td>\n      <td>0</td>\n      <td>248706</td>\n      <td>16.0000</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>17</td>\n      <td>0</td>\n      <td>3</td>\n      <td>Rice, Master. Eugene</td>\n      <td>0</td>\n      <td>2.000000</td>\n      <td>4</td>\n      <td>1</td>\n      <td>382652</td>\n      <td>29.1250</td>\n      <td>1</td>\n      <td>Q</td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>18</td>\n      <td>1</td>\n      <td>2</td>\n      <td>Williams, Mr. Charles Eugene</td>\n      <td>0</td>\n      <td>29.699118</td>\n      <td>0</td>\n      <td>0</td>\n      <td>244373</td>\n      <td>13.0000</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>19</td>\n      <td>0</td>\n      <td>3</td>\n      <td>Vander Planke, Mrs. Julius (Emelia Maria Vande...</td>\n      <td>1</td>\n      <td>31.000000</td>\n      <td>1</td>\n      <td>0</td>\n      <td>345763</td>\n      <td>18.0000</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>20</td>\n      <td>1</td>\n      <td>3</td>\n      <td>Masselmani, Mrs. Fatima</td>\n      <td>1</td>\n      <td>29.699118</td>\n      <td>0</td>\n      <td>0</td>\n      <td>2649</td>\n      <td>7.2250</td>\n      <td>1</td>\n      <td>C</td>\n    </tr>\n    <tr>\n      <th>20</th>\n      <td>21</td>\n      <td>0</td>\n      <td>2</td>\n      <td>Fynney, Mr. Joseph J</td>\n      <td>0</td>\n      <td>35.000000</td>\n      <td>0</td>\n      <td>0</td>\n      <td>239865</td>\n      <td>26.0000</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>21</th>\n      <td>22</td>\n      <td>1</td>\n      <td>2</td>\n      <td>Beesley, Mr. Lawrence</td>\n      <td>0</td>\n      <td>34.000000</td>\n      <td>0</td>\n      <td>0</td>\n      <td>248698</td>\n      <td>13.0000</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>22</th>\n      <td>23</td>\n      <td>1</td>\n      <td>3</td>\n      <td>McGowan, Miss. Anna \"Annie\"</td>\n      <td>1</td>\n      <td>15.000000</td>\n      <td>0</td>\n      <td>0</td>\n      <td>330923</td>\n      <td>8.0292</td>\n      <td>1</td>\n      <td>Q</td>\n    </tr>\n    <tr>\n      <th>23</th>\n      <td>24</td>\n      <td>1</td>\n      <td>1</td>\n      <td>Sloper, Mr. William Thompson</td>\n      <td>0</td>\n      <td>28.000000</td>\n      <td>0</td>\n      <td>0</td>\n      <td>113788</td>\n      <td>35.5000</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>24</th>\n      <td>25</td>\n      <td>0</td>\n      <td>3</td>\n      <td>Palsson, Miss. Torborg Danira</td>\n      <td>1</td>\n      <td>8.000000</td>\n      <td>3</td>\n      <td>1</td>\n      <td>349909</td>\n      <td>21.0750</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>25</th>\n      <td>26</td>\n      <td>1</td>\n      <td>3</td>\n      <td>Asplund, Mrs. Carl Oscar (Selma Augusta Emilia...</td>\n      <td>1</td>\n      <td>38.000000</td>\n      <td>1</td>\n      <td>5</td>\n      <td>347077</td>\n      <td>31.3875</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>26</th>\n      <td>27</td>\n      <td>0</td>\n      <td>3</td>\n      <td>Emir, Mr. Farred Chehab</td>\n      <td>0</td>\n      <td>29.699118</td>\n      <td>0</td>\n      <td>0</td>\n      <td>2631</td>\n      <td>7.2250</td>\n      <td>1</td>\n      <td>C</td>\n    </tr>\n    <tr>\n      <th>27</th>\n      <td>28</td>\n      <td>0</td>\n      <td>1</td>\n      <td>Fortune, Mr. Charles Alexander</td>\n      <td>0</td>\n      <td>19.000000</td>\n      <td>3</td>\n      <td>2</td>\n      <td>19950</td>\n      <td>263.0000</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>28</th>\n      <td>29</td>\n      <td>1</td>\n      <td>3</td>\n      <td>O'Dwyer, Miss. Ellen \"Nellie\"</td>\n      <td>1</td>\n      <td>29.699118</td>\n      <td>0</td>\n      <td>0</td>\n      <td>330959</td>\n      <td>7.8792</td>\n      <td>1</td>\n      <td>Q</td>\n    </tr>\n    <tr>\n      <th>29</th>\n      <td>30</td>\n      <td>0</td>\n      <td>3</td>\n      <td>Todoroff, Mr. Lalio</td>\n      <td>0</td>\n      <td>29.699118</td>\n      <td>0</td>\n      <td>0</td>\n      <td>349216</td>\n      <td>7.8958</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>70</th>\n      <td>71</td>\n      <td>0</td>\n      <td>2</td>\n      <td>Jenkin, Mr. Stephen Curnow</td>\n      <td>0</td>\n      <td>32.000000</td>\n      <td>0</td>\n      <td>0</td>\n      <td>C.A. 33111</td>\n      <td>10.5000</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>71</th>\n      <td>72</td>\n      <td>0</td>\n      <td>3</td>\n      <td>Goodwin, Miss. Lillian Amy</td>\n      <td>1</td>\n      <td>16.000000</td>\n      <td>5</td>\n      <td>2</td>\n      <td>CA 2144</td>\n      <td>46.9000</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>72</th>\n      <td>73</td>\n      <td>0</td>\n      <td>2</td>\n      <td>Hood, Mr. Ambrose Jr</td>\n      <td>0</td>\n      <td>21.000000</td>\n      <td>0</td>\n      <td>0</td>\n      <td>S.O.C. 14879</td>\n      <td>73.5000</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>73</th>\n      <td>74</td>\n      <td>0</td>\n      <td>3</td>\n      <td>Chronopoulos, Mr. Apostolos</td>\n      <td>0</td>\n      <td>26.000000</td>\n      <td>1</td>\n      <td>0</td>\n      <td>2680</td>\n      <td>14.4542</td>\n      <td>1</td>\n      <td>C</td>\n    </tr>\n    <tr>\n      <th>74</th>\n      <td>75</td>\n      <td>1</td>\n      <td>3</td>\n      <td>Bing, Mr. Lee</td>\n      <td>0</td>\n      <td>32.000000</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1601</td>\n      <td>56.4958</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>75</th>\n      <td>76</td>\n      <td>0</td>\n      <td>3</td>\n      <td>Moen, Mr. Sigurd Hansen</td>\n      <td>0</td>\n      <td>25.000000</td>\n      <td>0</td>\n      <td>0</td>\n      <td>348123</td>\n      <td>7.6500</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>76</th>\n      <td>77</td>\n      <td>0</td>\n      <td>3</td>\n      <td>Staneff, Mr. Ivan</td>\n      <td>0</td>\n      <td>29.699118</td>\n      <td>0</td>\n      <td>0</td>\n      <td>349208</td>\n      <td>7.8958</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>77</th>\n      <td>78</td>\n      <td>0</td>\n      <td>3</td>\n      <td>Moutal, Mr. Rahamin Haim</td>\n      <td>0</td>\n      <td>29.699118</td>\n      <td>0</td>\n      <td>0</td>\n      <td>374746</td>\n      <td>8.0500</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>78</th>\n      <td>79</td>\n      <td>1</td>\n      <td>2</td>\n      <td>Caldwell, Master. Alden Gates</td>\n      <td>0</td>\n      <td>0.830000</td>\n      <td>0</td>\n      <td>2</td>\n      <td>248738</td>\n      <td>29.0000</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>79</th>\n      <td>80</td>\n      <td>1</td>\n      <td>3</td>\n      <td>Dowdell, Miss. Elizabeth</td>\n      <td>1</td>\n      <td>30.000000</td>\n      <td>0</td>\n      <td>0</td>\n      <td>364516</td>\n      <td>12.4750</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>80</th>\n      <td>81</td>\n      <td>0</td>\n      <td>3</td>\n      <td>Waelens, Mr. Achille</td>\n      <td>0</td>\n      <td>22.000000</td>\n      <td>0</td>\n      <td>0</td>\n      <td>345767</td>\n      <td>9.0000</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>81</th>\n      <td>82</td>\n      <td>1</td>\n      <td>3</td>\n      <td>Sheerlinck, Mr. Jan Baptist</td>\n      <td>0</td>\n      <td>29.000000</td>\n      <td>0</td>\n      <td>0</td>\n      <td>345779</td>\n      <td>9.5000</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>82</th>\n      <td>83</td>\n      <td>1</td>\n      <td>3</td>\n      <td>McDermott, Miss. Brigdet Delia</td>\n      <td>1</td>\n      <td>29.699118</td>\n      <td>0</td>\n      <td>0</td>\n      <td>330932</td>\n      <td>7.7875</td>\n      <td>1</td>\n      <td>Q</td>\n    </tr>\n    <tr>\n      <th>83</th>\n      <td>84</td>\n      <td>0</td>\n      <td>1</td>\n      <td>Carrau, Mr. Francisco M</td>\n      <td>0</td>\n      <td>28.000000</td>\n      <td>0</td>\n      <td>0</td>\n      <td>113059</td>\n      <td>47.1000</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>84</th>\n      <td>85</td>\n      <td>1</td>\n      <td>2</td>\n      <td>Ilett, Miss. Bertha</td>\n      <td>1</td>\n      <td>17.000000</td>\n      <td>0</td>\n      <td>0</td>\n      <td>SO/C 14885</td>\n      <td>10.5000</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>85</th>\n      <td>86</td>\n      <td>1</td>\n      <td>3</td>\n      <td>Backstrom, Mrs. Karl Alfred (Maria Mathilda Gu...</td>\n      <td>1</td>\n      <td>33.000000</td>\n      <td>3</td>\n      <td>0</td>\n      <td>3101278</td>\n      <td>15.8500</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>86</th>\n      <td>87</td>\n      <td>0</td>\n      <td>3</td>\n      <td>Ford, Mr. William Neal</td>\n      <td>0</td>\n      <td>16.000000</td>\n      <td>1</td>\n      <td>3</td>\n      <td>W./C. 6608</td>\n      <td>34.3750</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>87</th>\n      <td>88</td>\n      <td>0</td>\n      <td>3</td>\n      <td>Slocovski, Mr. Selman Francis</td>\n      <td>0</td>\n      <td>29.699118</td>\n      <td>0</td>\n      <td>0</td>\n      <td>SOTON/OQ 392086</td>\n      <td>8.0500</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>88</th>\n      <td>89</td>\n      <td>1</td>\n      <td>1</td>\n      <td>Fortune, Miss. Mabel Helen</td>\n      <td>1</td>\n      <td>23.000000</td>\n      <td>3</td>\n      <td>2</td>\n      <td>19950</td>\n      <td>263.0000</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>89</th>\n      <td>90</td>\n      <td>0</td>\n      <td>3</td>\n      <td>Celotti, Mr. Francesco</td>\n      <td>0</td>\n      <td>24.000000</td>\n      <td>0</td>\n      <td>0</td>\n      <td>343275</td>\n      <td>8.0500</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>90</th>\n      <td>91</td>\n      <td>0</td>\n      <td>3</td>\n      <td>Christmann, Mr. Emil</td>\n      <td>0</td>\n      <td>29.000000</td>\n      <td>0</td>\n      <td>0</td>\n      <td>343276</td>\n      <td>8.0500</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>91</th>\n      <td>92</td>\n      <td>0</td>\n      <td>3</td>\n      <td>Andreasson, Mr. Paul Edvin</td>\n      <td>0</td>\n      <td>20.000000</td>\n      <td>0</td>\n      <td>0</td>\n      <td>347466</td>\n      <td>7.8542</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>92</th>\n      <td>93</td>\n      <td>0</td>\n      <td>1</td>\n      <td>Chaffee, Mr. Herbert Fuller</td>\n      <td>0</td>\n      <td>46.000000</td>\n      <td>1</td>\n      <td>0</td>\n      <td>W.E.P. 5734</td>\n      <td>61.1750</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>93</th>\n      <td>94</td>\n      <td>0</td>\n      <td>3</td>\n      <td>Dean, Mr. Bertram Frank</td>\n      <td>0</td>\n      <td>26.000000</td>\n      <td>1</td>\n      <td>2</td>\n      <td>C.A. 2315</td>\n      <td>20.5750</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>94</th>\n      <td>95</td>\n      <td>0</td>\n      <td>3</td>\n      <td>Coxon, Mr. Daniel</td>\n      <td>0</td>\n      <td>59.000000</td>\n      <td>0</td>\n      <td>0</td>\n      <td>364500</td>\n      <td>7.2500</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>95</th>\n      <td>96</td>\n      <td>0</td>\n      <td>3</td>\n      <td>Shorney, Mr. Charles Joseph</td>\n      <td>0</td>\n      <td>29.699118</td>\n      <td>0</td>\n      <td>0</td>\n      <td>374910</td>\n      <td>8.0500</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>96</th>\n      <td>97</td>\n      <td>0</td>\n      <td>1</td>\n      <td>Goldschmidt, Mr. George B</td>\n      <td>0</td>\n      <td>71.000000</td>\n      <td>0</td>\n      <td>0</td>\n      <td>PC 17754</td>\n      <td>34.6542</td>\n      <td>1</td>\n      <td>C</td>\n    </tr>\n    <tr>\n      <th>97</th>\n      <td>98</td>\n      <td>1</td>\n      <td>1</td>\n      <td>Greenfield, Mr. William Bertram</td>\n      <td>0</td>\n      <td>23.000000</td>\n      <td>0</td>\n      <td>1</td>\n      <td>PC 17759</td>\n      <td>63.3583</td>\n      <td>1</td>\n      <td>C</td>\n    </tr>\n    <tr>\n      <th>98</th>\n      <td>99</td>\n      <td>1</td>\n      <td>2</td>\n      <td>Doling, Mrs. John T (Ada Julia Bone)</td>\n      <td>1</td>\n      <td>34.000000</td>\n      <td>0</td>\n      <td>1</td>\n      <td>231919</td>\n      <td>23.0000</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n    <tr>\n      <th>99</th>\n      <td>100</td>\n      <td>0</td>\n      <td>2</td>\n      <td>Kantor, Mr. Sinai</td>\n      <td>0</td>\n      <td>34.000000</td>\n      <td>1</td>\n      <td>0</td>\n      <td>244367</td>\n      <td>26.0000</td>\n      <td>1</td>\n      <td>S</td>\n    </tr>\n  </tbody>\n</table>\n<p>100 rows Ã— 12 columns</p>\n</div>"
          },
          "metadata": {}
        }
      ]
    },
    {
      "metadata": {
        "trusted": true,
        "_uuid": "ea3fc7b61ca4972c1b282de63af5ac38328dfc8c"
      },
      "cell_type": "code",
      "source": "dataset.drop(['Name', 'Ticket', 'PassengerId', 'Embarked'], axis=1, inplace=True)",
      "execution_count": 137,
      "outputs": []
    },
    {
      "metadata": {
        "trusted": true,
        "_uuid": "f9302b9e64f3e8155348b6c317bb4a5d4e6e3472"
      },
      "cell_type": "code",
      "source": "dataset.head()",
      "execution_count": 138,
      "outputs": [
        {
          "output_type": "execute_result",
          "execution_count": 138,
          "data": {
            "text/plain": "   Survived  Pclass  Sex   Age  SibSp  Parch     Fare  Cabin\n0         0       3    0  22.0      1      0   7.2500      1\n1         1       1    1  38.0      1      0  71.2833      1\n2         1       3    1  26.0      0      0   7.9250      1\n3         1       1    1  35.0      1      0  53.1000      1\n4         0       3    0  35.0      0      0   8.0500      1",
            "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Survived</th>\n      <th>Pclass</th>\n      <th>Sex</th>\n      <th>Age</th>\n      <th>SibSp</th>\n      <th>Parch</th>\n      <th>Fare</th>\n      <th>Cabin</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0</td>\n      <td>3</td>\n      <td>0</td>\n      <td>22.0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>7.2500</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>38.0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>71.2833</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>1</td>\n      <td>3</td>\n      <td>1</td>\n      <td>26.0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>7.9250</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>35.0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>53.1000</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>0</td>\n      <td>3</td>\n      <td>0</td>\n      <td>35.0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>8.0500</td>\n      <td>1</td>\n    </tr>\n  </tbody>\n</table>\n</div>"
          },
          "metadata": {}
        }
      ]
    },
    {
      "metadata": {
        "trusted": true,
        "collapsed": true,
        "_uuid": "7919f0d8c805ac5c5036ab477dd1f75350d42780"
      },
      "cell_type": "code",
      "source": "# Logistic Regression\nX = dataset\ny = X.pop('Survived')",
      "execution_count": 139,
      "outputs": []
    },
    {
      "metadata": {
        "trusted": true,
        "_uuid": "a5268319927ef2274c05f37f28084f351f4c8a9e"
      },
      "cell_type": "code",
      "source": "X.head()",
      "execution_count": 140,
      "outputs": [
        {
          "output_type": "execute_result",
          "execution_count": 140,
          "data": {
            "text/plain": "   Pclass  Sex   Age  SibSp  Parch     Fare  Cabin\n0       3    0  22.0      1      0   7.2500      1\n1       1    1  38.0      1      0  71.2833      1\n2       3    1  26.0      0      0   7.9250      1\n3       1    1  35.0      1      0  53.1000      1\n4       3    0  35.0      0      0   8.0500      1",
            "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Pclass</th>\n      <th>Sex</th>\n      <th>Age</th>\n      <th>SibSp</th>\n      <th>Parch</th>\n      <th>Fare</th>\n      <th>Cabin</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>3</td>\n      <td>0</td>\n      <td>22.0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>7.2500</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1</td>\n      <td>1</td>\n      <td>38.0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>71.2833</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>3</td>\n      <td>1</td>\n      <td>26.0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>7.9250</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>1</td>\n      <td>1</td>\n      <td>35.0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>53.1000</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>3</td>\n      <td>0</td>\n      <td>35.0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>8.0500</td>\n      <td>1</td>\n    </tr>\n  </tbody>\n</table>\n</div>"
          },
          "metadata": {}
        }
      ]
    },
    {
      "metadata": {
        "trusted": true,
        "_uuid": "1cad708da538564dccefc93b88fbb0d9e38a1f57"
      },
      "cell_type": "code",
      "source": "y.head()",
      "execution_count": 141,
      "outputs": [
        {
          "output_type": "execute_result",
          "execution_count": 141,
          "data": {
            "text/plain": "0    0\n1    1\n2    1\n3    1\n4    0\nName: Survived, dtype: int64"
          },
          "metadata": {}
        }
      ]
    },
    {
      "metadata": {
        "trusted": true,
        "collapsed": true,
        "_uuid": "0f268293d599d0a3d6d78963a3a125b5031194ac"
      },
      "cell_type": "code",
      "source": "X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)",
      "execution_count": 142,
      "outputs": []
    },
    {
      "metadata": {
        "trusted": true,
        "_uuid": "67c04f8e0cfb9016cdd8a9d8c699be6f3d6f4417"
      },
      "cell_type": "code",
      "source": "log_reg = LogisticRegression() ",
      "execution_count": 143,
      "outputs": []
    },
    {
      "metadata": {
        "trusted": true,
        "_uuid": "26288104abef99518b8f36e17f5ce4598b72653d"
      },
      "cell_type": "code",
      "source": "log_reg.fit(X_train, y_train)",
      "execution_count": 144,
      "outputs": [
        {
          "output_type": "execute_result",
          "execution_count": 144,
          "data": {
            "text/plain": "LogisticRegression(C=1.0, class_weight=None, dual=False, fit_intercept=True,\n          intercept_scaling=1, max_iter=100, multi_class='ovr', n_jobs=1,\n          penalty='l2', random_state=None, solver='liblinear', tol=0.0001,\n          verbose=0, warm_start=False)"
          },
          "metadata": {}
        }
      ]
    },
    {
      "metadata": {
        "trusted": true,
        "_uuid": "987fb2fa2d2dd0a34164c02a9517965cb80cee90"
      },
      "cell_type": "code",
      "source": "#This is the accuracy of the model\nlog_reg.score(X_test, y_test)",
      "execution_count": 145,
      "outputs": [
        {
          "output_type": "execute_result",
          "execution_count": 145,
          "data": {
            "text/plain": "0.7988826815642458"
          },
          "metadata": {}
        }
      ]
    },
    {
      "metadata": {
        "trusted": true,
        "_uuid": "97e95660f0b281edcd23f863285cb41290552ae4"
      },
      "cell_type": "code",
      "source": "log_reg.coef_",
      "execution_count": 146,
      "outputs": [
        {
          "output_type": "execute_result",
          "execution_count": 146,
          "data": {
            "text/plain": "array([[-0.87799489,  2.6107604 , -0.02965159, -0.31301288, -0.13034082,\n         0.00388348,  0.72563013]])"
          },
          "metadata": {}
        }
      ]
    },
    {
      "metadata": {
        "trusted": true,
        "_uuid": "183bd27e43df9e352281bc21def224582ecab647"
      },
      "cell_type": "code",
      "source": "log_reg.intercept_",
      "execution_count": 147,
      "outputs": [
        {
          "output_type": "execute_result",
          "execution_count": 147,
          "data": {
            "text/plain": "array([0.72563013])"
          },
          "metadata": {}
        }
      ]
    },
    {
      "metadata": {
        "trusted": true,
        "scrolled": true,
        "_uuid": "7ea45174acaff81c89d7527525cdd16f74436e8f"
      },
      "cell_type": "code",
      "source": "print(\"Probability: e^({} + {}*X_1 + {}*X_2 + {}*X_3 + {}*X_4 + {}*X_5 + {}*X_6 + {}*X_7\".format(\n    log_reg.intercept_[0],\n    log_reg.coef_ [0][0],\n    log_reg.coef_ [0][1],\n    log_reg.coef_ [0][2],\n    log_reg.coef_ [0][3],\n    log_reg.coef_ [0][4],\n    log_reg.coef_ [0][5],\n    log_reg.coef_ [0][6]))\nprint(\"Where X_1 = Pclass\\n      X_2 = Sex\\n      X_3 = Age\\n      X_4 = SibSp\\n      X_5 = Parch\\n      X_6 = Fare\\n      X_7 = Cabin\")",
      "execution_count": 148,
      "outputs": [
        {
          "output_type": "stream",
          "text": "Probability: e^(0.7256301253911296 + -0.8779948921711697*X_1 + 2.610760400914125*X_2 + -0.029651589579269718*X_3 + -0.3130128820059686*X_4 + -0.13034081728108624*X_5 + 0.0038834803596325966*X_6 + 0.7256301253911296*X_7\nWhere X_1 = Pclass\n      X_2 = Sex\n      X_3 = Age\n      X_4 = SibSp\n      X_5 = Parch\n      X_6 = Fare\n      X_7 = Cabin\n",
          "name": "stdout"
        }
      ]
    },
    {
      "metadata": {
        "trusted": true,
        "_uuid": "c4719ee646470db0b9ae9f9ec2ca7e0d3a84e6f7"
      },
      "cell_type": "code",
      "source": "math.exp(log_reg.intercept_[0] + log_reg.coef_ [0][0]* 3 + \n         log_reg.coef_ [0][1]* 0 + \n         log_reg.coef_ [0][2]* 22 + \n         log_reg.coef_ [0][3]* 1 + \n         log_reg.coef_ [0][4]* 0 + \n         log_reg.coef_ [0][5]* 14.45 + \n         log_reg.coef_ [0][6]* 1)",
      "execution_count": 149,
      "outputs": [
        {
          "output_type": "execute_result",
          "execution_count": 149,
          "data": {
            "text/plain": "0.12344544180480999"
          },
          "metadata": {}
        }
      ]
    },
    {
      "metadata": {
        "trusted": true,
        "_uuid": "f104699b4cbf8edede9b355b525c47eb500312f8"
      },
      "cell_type": "code",
      "source": "print(\"So a person who is Pclass = 0, sex = male, age = 22, SinSp = 1, Parch = 0, Fare = 14.45 (median), and cabin = 1 has a 12% chance of survival\")",
      "execution_count": 150,
      "outputs": [
        {
          "output_type": "stream",
          "text": "So a person who is Pclass = 0, sex = male, age = 22, SinSp = 1, Parch = 0, Fare = 14.45 (median), and cabin = 1 has a 12% chance of survival\n",
          "name": "stdout"
        }
      ]
    },
    {
      "metadata": {
        "trusted": true,
        "_uuid": "25ce5681511875e825cfff624e8bef09832aeb53"
      },
      "cell_type": "code",
      "source": "math.exp(log_reg.intercept_[0] + log_reg.coef_ [0][0]* 3 + \n         log_reg.coef_ [0][1]* 1 + \n         log_reg.coef_ [0][2]* 1 + \n         log_reg.coef_ [0][3]* 1 + \n         log_reg.coef_ [0][4]* 0 + \n         log_reg.coef_ [0][5]* 14.45 + \n         log_reg.coef_ [0][6]* 1)",
      "execution_count": 152,
      "outputs": [
        {
          "output_type": "execute_result",
          "execution_count": 152,
          "data": {
            "text/plain": "3.131423817202837"
          },
          "metadata": {}
        }
      ]
    },
    {
      "metadata": {
        "trusted": true,
        "collapsed": true,
        "_uuid": "67bed1c4f6c9e68bd2a211e0e41e5be6e156a28b"
      },
      "cell_type": "code",
      "source": "",
      "execution_count": null,
      "outputs": []
    }
  ],
  "metadata": {
    "language_info": {
      "name": "python",
      "version": "3.6.5",
      "mimetype": "text/x-python",
      "codemirror_mode": {
        "name": "ipython",
        "version": 3
      },
      "pygments_lexer": "ipython3",
      "nbconvert_exporter": "python",
      "file_extension": ".py"
    },
    "kernelspec": {
      "display_name": "Python 3",
      "language": "python",
      "name": "python3"
    }
  },
  "nbformat": 4,
  "nbformat_minor": 1
}